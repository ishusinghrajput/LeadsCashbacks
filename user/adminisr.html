<!DOCTYPE html>
<html>
    <head>
        <title>
            Admin Console
        </title>
        <meta name="viewport" content="width=device-width , initial-scale = 1.0">
        <link rel="stylesheet" type="text/css" href="adminstyle.css">
       

    </head>
    <body>
      <div class="toplogo" >
        <img src="logoblack.png" class="logo" onclick="gotohome()" />
        <div class="nav">
            <img src="bulletlist.png" id="bulletlist"  class="bulletlist" onclick="shownavitems()">
        <div class="navitems" id="navitems" style="display: none;">
            <a href="https://leadscashbacks.ml" class="navhome">Home</a>
            <a href="buynow" class="navbuynow">Buy Now</a>
            <a id="navclaim" class="navclaim">Claim Cashback</a>
            <a id="navlogin" class="navlogin">Login</a>
        </div>
        </div>
      </div>
        <div class="main">
        <div class="form" id="form">
            <h1 class="addtext">Add Subscribed Users</h1>
            <input class="email" id="email" type="text" 
            aria-label="Enter Email" placeholder="Enter Email">
            <label class="planlabel" for="plan">Choose Plan</label>
            <select name="plan" class="plan" id="plan">
                <option value="500">Lite</option>
                <option value="1000">Standard</option>
                <option value="2000">Pro</option>
            </select>
            <a  id="addbtn" class="addbtn" >Add</a>
        </div>
    </div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.5/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.5/firebase-analytics.js";
        import { getAuth, onAuthStateChanged , signOut , createUserWithEmailAndPassword , signInWithEmailAndPassword , sendEmailVerification } from "https://www.gstatic.com/firebasejs/9.6.5/firebase-auth.js";
        import { getDatabase , ref , set , push , child } from "https://www.gstatic.com/firebasejs/9.6.5/firebase-database.js";

        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyAmVcedI8Rm6OEs-zVDL34NGdA-AsSg_yE",
          authDomain: "leadscashbacks.firebaseapp.com",
          databaseURL: "https://leadscashbacks-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "leadscashbacks",
          storageBucket: "leadscashbacks.appspot.com",
          messagingSenderId: "122044315259",
          appId: "1:122044315259:web:b140cd3a156ea5782614de",
          measurementId: "G-8Z17ZG5V4L"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth();
        const database = getDatabase();

        onAuthStateChanged(auth, (user) => {
     if (user) {
// User is signed in, see docs for a list of available properties
// https://firebase.google.com/docs/reference/js/firebase.User

const uid = user.uid;
const currentuser = auth.currentuser;

document.getElementById("navlogin").innerHTML = "Logout";
if (user !== null) {
  user.providerData.forEach((profile) => {
     
      if (profile.email === "ishusinghh.135@gmail.com") {
          
      }
      else{
          location.href = "profile.html";
      }
  });
}



// ...
} else {
// User is signed out
document.getElementById("navlogin").innerHTML = "Login";
location.href = "login.html"
// ...
}
});


    document.getElementById("addbtn").addEventListener('click' , (e) => {
        var loading = document.getElementById("loading");
        loading.style.display = "block";
        document.getElementById("addbtn").innerHTML = "Adding...";

        onAuthStateChanged(auth, (user) => {
        if (user) {

        const uid = user.uid;
        const currentuser = auth.currentuser;
          if (user !== null) {
            user.providerData.forEach((profile) => {
     
            if (profile.email === "ishusinghh.135@gmail.com") {
                var useremail = document.getElementById("email").value;
                var balance = document.getElementById("plan").value;

                const db = getDatabase();
                push(ref(db, 'subscribedusers/' ) ,  {
                  email:useremail,
                  balance:balance
                
                });

            }
            else{
                document.getElementById("loading").style.display = "none";
                document.getElementById("addbtn").innerHTML = "Add";
                location.href = "profile.html"
            }
           });
          }

        } else {
            // User is signed out
            document.getElementById("loading").style.display = "none";
            document.getElementById("addbtn").innerHTML = "Add";
            location.href = "login.html"
        }
     });
    });


    document.getElementById("navlogin").addEventListener('click' , (e) => {
        onAuthStateChanged(auth, (user) => {
         if (user) {
    // User is signed in, see docs for a list of available properties
    // https://firebase.google.com/docs/reference/js/firebase.User
    
    const uid = user.uid;
    //Sign out
signOut(auth).then(() => {
  // Sign-out successful.
}).catch((error) => {
  // An error happened.
});
    // ...
  } else {
    // User is signed out
   
    location.href = "login.html";
    // ...
  }
        });   
     });


     document.getElementById("navclaim").addEventListener('click' , (e) => {
        onAuthStateChanged(auth, (user) => {
         if (user) {
    // User is signed in, see docs for a list of available properties
    // https://firebase.google.com/docs/reference/js/firebase.User
    
    const uid = user.uid;
    
    location.href = "profile.html";

    // ...
  } else {
    // User is signed out
   
    location.href = "signup.html";
    // ...
  }
        });   
     });

    </script>

    <script>
    function shownavitems() {
       if(document.getElementById("navitems").style.display==="none"){
         document.getElementById("navitems").style.display = "block"; 
       }
       else {
         document.getElementById("navitems").style.display = "none"; 
        }
 
    }

    function gotohome() {
         location.href = "https://leadscashbacks.ml"
     
        }

    </script>

<script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
<lottie-player id="loading" class="loading" src="https://assets9.lottiefiles.com/packages/lf20_szlepvdh.json"  background="transparent"
  speed="1"  style="width: 300px; height: 300px;"  loop  autoplay></lottie-player>


    </body>

    
    
</html>



